!function(t){"use strict";var i=function(i,e,o){return this.el=i,this.$el=t(i),this.options=e,this.uuid=this.$el.attr("id")?this.$el.attr("id"):o,this.state={},this.init(),this};i.prototype={init:function(){var i=this;i._load(),i.$el.find("ul").each((function(e){var o=t(this);o.attr("data-index",e),i.options.save&&i.state.hasOwnProperty(e)?(o.parent().addClass(i.options.openClass),o.show()):o.parent().hasClass(i.options.openClass)?(o.show(),i.state[e]=1):o.hide()}));var e=t("<span></span>").prepend(i.options.caretHtml),o=i.$el.find("li > a");i._trigger(e,!1),i._trigger(o,!0),i.$el.find("li:has(ul) > a").prepend(e)},_trigger:function(i,e){var o=this;i.on("click",(function(i){i.stopPropagation();var n=e?t(this).next():t(this).parent().next(),a=!1;if(e){var s=t(this).attr("href");a=void 0===s||""===s||"#"===s}if(n=n.length>0&&n,o.options.onClickBefore.call(this,i,n),!e||n&&a)i.preventDefault(),o._toggle(n,n.is(":hidden")),o._save();else if(o.options.accordion){var r=o.state=o._parents(t(this));o.$el.find("ul").filter(":visible").each((function(){var i=t(this),e=i.attr("data-index");r.hasOwnProperty(e)||o._toggle(i,!1)})),o._save()}o.options.onClickAfter.call(this,i,n)}))},_toggle:function(i,e){var o=this,n=i.attr("data-index"),a=i.parent();if(o.options.onToggleBefore.call(this,i,e),e){if(a.addClass(o.options.openClass),i.slideDown(o.options.slide),o.state[n]=1,o.options.accordion){var s=o.state=o._parents(i);s[n]=o.state[n]=1,o.$el.find("ul").filter(":visible").each((function(){var i=t(this),e=i.attr("data-index");s.hasOwnProperty(e)||o._toggle(i,!1)}))}}else a.removeClass(o.options.openClass),i.slideUp(o.options.slide),o.state[n]=0;o.options.onToggleAfter.call(this,i,e)},_parents:function(i,e){var o={};return i.parent().parents("ul").each((function(){var i=t(this),n=i.attr("data-index");if(!n)return!1;o[n]=e?i:1})),o},_save:function(){if(this.options.save){var i={};for(var o in this.state)1===this.state[o]&&(i[o]=1);e[this.uuid]=this.state=i,t.cookie(this.options.cookie.name,JSON.stringify(e),this.options.cookie)}},_load:function(){if(this.options.save){if(null===e){var i=t.cookie(this.options.cookie.name);e=i?JSON.parse(i):{}}this.state=e.hasOwnProperty(this.uuid)?e[this.uuid]:{}}},toggle:function(i){var e=this,o=arguments.length;if(o<=1)e.$el.find("ul").each((function(){var o=t(this);e._toggle(o,i)}));else{var n,a={},s=Array.prototype.slice.call(arguments,1);o--;for(var r=0;r<o;r++){n=s[r];var l=e.$el.find('ul[data-index="'+n+'"]').first();if(l&&(a[n]=l,i)){var h=e._parents(l,!0);for(var p in h)a.hasOwnProperty(p)||(a[p]=h[p])}}for(n in a)e._toggle(a[n],i)}e._save()},destroy:function(){t.removeData(this.$el),this.$el.find("li:has(ul) > a").unbind("click"),this.$el.find("li:has(ul) > a > span").unbind("click")}},t.fn.navgoco=function(e){if("string"==typeof e&&"_"!==e.charAt(0)&&"init"!==e)var o=!0,n=Array.prototype.slice.call(arguments,1);else e=t.extend({},t.fn.navgoco.defaults,e||{}),t.cookie||(e.save=!1);return this.each((function(a){var s=t(this),r=s.data("navgoco");r||(r=new i(this,o?t.fn.navgoco.defaults:e,a),s.data("navgoco",r)),o&&r[e].apply(r,n)}))};var e=null;t.fn.navgoco.defaults={caretHtml:"",accordion:!1,openClass:"open",save:!0,cookie:{name:"navgoco",expires:!1,path:"/"},slide:{duration:400,easing:"swing"},onClickBefore:t.noop,onClickAfter:t.noop,onToggleBefore:t.noop,onToggleAfter:t.noop}}(jQuery);